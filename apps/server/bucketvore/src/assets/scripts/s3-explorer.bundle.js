(()=>{"use strict";function e(){return{selectedBucket:"",currentPrefix:"",buckets:[],files:[],folders:[],viewMode:"list",bucketsHtml:'<div class="loading"><div class="spinner"></div><p>Loading buckets...</p></div>',filesHtml:"",breadcrumbsHtml:"",bucketFilter:"",fileFilter:"",showUpload:!1,showPreview:!1,uploadProgress:[],uploadProgressHtml:"",previewHtml:"",activeTab:"data",get filteredBucketsHtml(){if(!this.bucketFilter.trim())return this.bucketsHtml;const e=(new DOMParser).parseFromString(this.bucketsHtml,"text/html");return e.querySelectorAll(".bucket-item").forEach(e=>{(e.querySelector(".bucket-name")?.textContent?.toLowerCase()||"").includes(this.bucketFilter.toLowerCase())?e.style.display="":e.style.display="none"}),0===e.querySelectorAll('.bucket-item:not([style*="display: none"])').length?'<div class="empty-state"><div class="empty-state-icon">üîç</div><p>No buckets match your filter</p></div>':e.body.innerHTML},get filteredFilesHtml(){if(!this.fileFilter.trim()||!this.filesHtml)return this.filesHtml;const e=(new DOMParser).parseFromString(this.filesHtml,"text/html");return e.querySelectorAll(".file-item").forEach(e=>{(e.querySelector(".file-name")?.textContent?.toLowerCase()||"").includes(this.fileFilter.toLowerCase())?e.style.display="":e.style.display="none"}),0===e.querySelectorAll('.file-item:not([style*="display: none"])').length?'<div class="empty-state"><div class="empty-state-icon">üîç</div><p>No files match your filter</p></div>':e.body.innerHTML},async init(){await this.loadBuckets()},async loadBuckets(){try{const e=await fetch("/api/buckets");this.bucketsHtml=await e.text()}catch(e){this.bucketsHtml='<div class="error"><div class="error-icon">‚ö†Ô∏è</div><p>Error loading buckets</p></div>'}},async selectBucket(e){this.selectedBucket=e,this.currentPrefix="",this.fileFilter="",await this.loadFiles()},async loadFiles(){try{const e=new URLSearchParams({bucket:this.selectedBucket,prefix:this.currentPrefix}),t=await fetch(`/api/files?${e}`),i=await t.json();this.filesHtml=i.filesHtml||"",this.breadcrumbsHtml=i.breadcrumbsHtml||""}catch(e){this.filesHtml='<div class="error"><div class="error-icon">‚ö†Ô∏è</div><p>Error loading files</p></div>'}},async navigateToFolder(e){this.currentPrefix=e,this.fileFilter="",await this.loadFiles()},async previewFile(e){try{const t=new URLSearchParams({bucket:this.selectedBucket,key:e}),i=await fetch(`/api/files/preview?${t}`);this.previewHtml=await i.text(),this.showPreview=!0}catch(e){alert("Error loading preview")}},closePreview(){this.showPreview=!1,this.previewHtml=""},async downloadFile(e){try{const t=new URLSearchParams({bucket:this.selectedBucket,key:e}),i=await fetch(`/api/files/download?${t}`),s=await i.json();window.open(s.url,"_blank")}catch(e){alert("Error generating download link")}},async deleteFile(e){if(confirm(`Delete ${e}?`))try{await fetch("/api/files/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bucket:this.selectedBucket,key:e})}),await this.loadFiles()}catch(e){alert("Error deleting file")}},async copyS3Path(e){const t=event?.target;await async function(e,t,i){try{const s=await fetch(`/api/buckets/${encodeURIComponent(e)}/region`),a=`https://s3.${(await s.json()).region||"us-east-1"}.amazonaws.com/${e}/${t}`;await async function(e,t){try{if(await navigator.clipboard.writeText(e),t){const e=t.textContent||"",i=t.style.backgroundColor;t.textContent="‚úì Copied!",t.style.backgroundColor="var(--color-success)",setTimeout(()=>{t.textContent=e,t.style.backgroundColor=i},1500)}return!0}catch(t){return console.error("Clipboard API failed:",t),null!==prompt("Copy to clipboard:",e)}}(a,i)}catch(i){console.error("Error getting S3 URL:",i),prompt("Copy S3 path (fallback):",`s3://${e}/${t}`)}}(this.selectedBucket,e,t)},async deleteFolder(e){if(confirm(`Delete folder ${e} and all its contents?`))try{await fetch("/api/files/delete-folder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bucket:this.selectedBucket,prefix:e})}),await this.loadFiles()}catch(e){alert("Error deleting folder")}},handleFileSelect(e){const t=e.target;if(t.files){const e=Array.from(t.files);this.uploadFiles(e)}},handleDrop(e){if(e.target.classList.remove("drag-over"),e.dataTransfer?.files){const t=Array.from(e.dataTransfer.files);this.uploadFiles(t)}},async uploadFiles(e){this.uploadProgress=e.map(e=>({name:e.name,status:"Uploading..."}));for(let t=0;t<e.length;t++){const i=e[t],s=new FormData;s.append("file",i),s.append("bucket",this.selectedBucket),s.append("prefix",this.currentPrefix);try{await fetch("/api/upload",{method:"POST",body:s}),this.uploadProgress[t].status="‚úì Complete"}catch(e){this.uploadProgress[t].status="‚úó Failed"}}setTimeout(async()=>{this.uploadProgress=[],this.showUpload=!1,await this.loadFiles()},2e3)},async refresh(){await this.loadFiles()},filterBuckets(){},filterFiles(){}}}"undefined"!=typeof window&&(window.Alpine?window.Alpine.data("s3Explorer",e):document.addEventListener("alpine:init",()=>{window.Alpine.data("s3Explorer",e)}))})();
//# sourceMappingURL=s3-explorer.bundle.js.map